<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Blockly Dev Workspace</title>
    <script src="blockly/blockly_compressed.js"></script>
    <script src="blockly/blocks_compressed.js"></script>
    <script src="custom/blocks/block_alter.js"></script>
    <script src="custom/blocks/block_create.js"></script>
    <script src="custom/blocks/block_drop.js"></script>
    <script src="custom/blocks/block_insert.js"></script>
    <script src="custom/blocks/block_select.js"></script>
    <script src="custom/blocks/block_update.js"></script>
    <script src="custom/blocks/columndefinition.js"></script>
    <script src="custom/blocks/conditions.js"></script>
    <script src="custom/blocks/entities.js"></script>
    <script src="custom/blocks/data.js"></script>
    <script src="custom/generators/sql.js"></script>
    <script src="custom/generators/sql/block_alter.js"></script>
    <script src="custom/generators/sql/block_create.js"></script>
    <script src="custom/generators/sql/block_select.js"></script>
    <script src="custom/generators/sql/block_drop.js"></script>
    <script src="custom/generators/sql/block_insert.js"></script>
    <script src="custom/generators/sql/block_update.js"></script>
    <script src="custom/generators/sql/columndefinition.js"></script>
    <script src="custom/generators/sql/entities.js"></script>
    <script src="custom/generators/sql/conditions.js"></script>
    <script src="custom/generators/sql/data.js"></script>
    <script src="blockly/msg/js/de.js"></script>
    <script src="custom/msg/js/de.js"></script>
    <style>
        body {
            background-color: #fff;
            font-family: sans-serif;
        }

        h1 {
            font-weight: normal;
            font-size: 140%;
        }
    </style>
</head>
<body>
<div id="wrapper" style="width:100%;">
    <div id="blocklyDiv" style="height: 800px; width: 70%; float:left"></div>
    <div id="content" style="height: 800px; width: 25%; float:right;">Generated Code:
        <textarea id="textarea" cols="50" rows="50">Es war dunkel, feucht und neblig â€¦</textarea>
    </div>
</div>

<xml id="toolbox" style="display: none">
    <category name="ALTER">
        <block type="block_alter"></block>
        <block type="alter_rename_to"></block>
        <block type="alter_rename_column"></block>
        <block type="alter_add_column"></block>
        <block type="columndefinition"></block>
    </category>
    <category name="CREATE" colour="#5ba56d">
        <block type="block_create">
            <value name="TABLE">
                <shadow type="data_string">
                    <field name="STRING">tablename</field>
                </shadow>
            </value>
        </block>
		<block type="columndefinition"></block>
    </category>
    <category name="DROP">
        <block type="block_drop"></block>
    </category>
    <category name="INSERT">
        <block type="block_insert"></block>
    </category>
    <category name="SELECT">
        <block type="block_select">

        </block>
        <block type="block_subselect"></block>
        <block type="select_join"></block>
        <block type="select_where"></block>
        <block type="select_group"></block>
        <block type="select_group_having"></block>
        <block type="select_order"></block>
        <block type="select_limit"></block>
        <block type="cond_block"></block>
    </category>
    <category name="UPDATE">
        <block type="block_update"></block>
        <block type="update_where"></block>
        <block type="columntovalue"></block>
    </category>
    <sep></sep>
    <category name="CONDITION">
        <block type="cond_block"></block>
        <block type="cond_not"></block>
        <block type="cond_or"></block>
        <block type="cond_and"></block>
    </category>
    <sep></sep>
    <category name="DATAELEMENTS">
        <block type="data_boolean"></block>
        <block type="data_boolean_statement"></block>
        <block type="data_string"></block>
        <block type="data_string_statement"></block>
        <block type="data_number"></block>
        <block type="data_number_statement"></block>
        <block type="data_date"></block>
        <block type="data_date_statement"></block>
        <block type="data_datetime"></block>
        <block type="data_datetime_statement"></block>
    </category>
    <category name="ENTITIES">
        <block type="entity_table"></block>
        <block type="entity_table_statement"></block>
        <block type="entitiy_column"></block>
        <block type="entity_column_statement"></block>
    </category>
</xml>

<script>
    let demoWorkspace = Blockly.inject('blocklyDiv',
        {toolbox: document.getElementById('toolbox'),
            maxInstances: {'block_select': 1}});


    function myUpdateFunction(event) {
        const code = Blockly.SQL.workspaceToCode(demoWorkspace);
        document.getElementById('textarea').value = code;
    }

    demoWorkspace.addChangeListener(myUpdateFunction);
</script>

</body>
</html>
